sudo: required
dist: trusty

language: python
python:
  - "3.6"

install:
  - docker build -t umccr/umccrise .

script:
  - docker run -t --cpus 1 umccr/umccrise bcftools --version
  - docker run -t --cpus 1 umccr/umccrise umccrise --version

services:
  - docker
addons:
  apt:
    packages:
      - docker-ce

deploy:
  - provider: script
    script: echo "$DOCKER_PASSWORD" | docker login --username "$DOCKER_USER" --password-stdin &&
            docker tag umccr/umccrise umccr/umccrise:$TRAVIS_TAG &&
            docker push umccr/umccrise:$TRAVIS_TAG
    on:
      tags: true
    skip_cleanup: true
